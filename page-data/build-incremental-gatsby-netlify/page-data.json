{"componentChunkName":"component---src-templates-blog-post-js","path":"/build-incremental-gatsby-netlify/","result":{"data":{"markdownRemark":{"html":"<h2 id=\"introducao\">Introdução</h2>\n<p>Dando uma leve pausa dos <a href=\"https://lhuria94.github.io/series/#dicas-de-css\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">vídeos de dicas de CSS</a>, o post de hoje vai ser rapidinho, mas foi extremamente útil para mim e tenho certeza que será super útil para todos aqueles que já fizeram o meu <a href=\"https://www.udemy.com/course/gatsby-crie-um-site-pwa-com-react-graphql-e-netlify-cms/?couponCode=ESTUDEEMCASA\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Curso de Gatsby: Crie um Site PWA com React, GraphQL e Netlify CMS</a>.</p>\n<p>Ontem o Gatsby lançou essa nova feature chamada de <a href=\"https://www.gatsbyjs.org/docs/page-build-optimizations-for-incremental-data-changes/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Experimental Page Build Optimizations for Incremental Data Changes</a>, onde eles criam um cache e fazem o build somente do que é necessário, fazendo com que certos builds que demoravam <strong>~10min</strong> passem a demorar <strong>~1min</strong>!</p>\n<p>Existem duas vantagens nisso, a primeira e mais óbvia é o ganho de tempo, já que você terá algo no ar muito mais rápido. A outra questão é que se você utiliza o <a href=\"https://www.netlify.com/pricing/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Netlify gratuito</a> deve saber que eles deixam somente <strong>300 minutos/mês</strong>. Ou seja, em 30 deploys você acabaria gastando toda a quota do mês e isso não é nada legal né?</p>\n<p>Bom, vamos deixar de papo furado e fazer logo isso funcionar né? Dá o play nessa <a href=\"https://open.spotify.com/playlist/37i9dQZF1DX0wMD4IoQ5aJ?si=-A5AVvQYQ76dRp_ZHFgzIQ\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">playlist de Eletronic Focus</a> e vamos nessa!</p>\n<h3 id=\"passo-1---atualize-o-gatsby-para-v2204-ou-maior\">Passo 1 - Atualize o Gatsby para v2.20.4 ou maior</h3>\n<p>Essa nova feature veio somente na versão mais atual, então rode:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># se utilizar npm</span>\n<span class=\"token function\">npm</span> <span class=\"token function\">install</span> gatsby@latest\n\n<span class=\"token comment\"># se utilizar yarn</span>\n<span class=\"token function\">yarn</span> upgrade gatsby@latest</code></pre></div>\n<h3 id=\"passo-2---habilite-o-netlify-build-plugins\">Passo 2 - Habilite o Netlify Build Plugins</h3>\n<p>Para que a gente consiga salvar o cache entre os builds é necessário utilizar um build plugin, como essa é uma feature bem nova do Netlify, é necessário que você habilite através do <a href=\"https://app.netlify.com/enable-beta\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">seguinte link</a>.</p>\n<p>Para saber mais informações do Beta, só <a href=\"https://docs.netlify.com/configure-builds/build-plugins/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">entrar neste link</a>.</p>\n<h3 id=\"passo-3---adicione-o-gatsby-cache-netlify-build-plugin\">Passo 3 - Adicione o Gatsby Cache Netlify Build Plugin</h3>\n<p>Os builds incrementais dependem completamente do cache do Gatsby, portanto precisamos habilitar o <code class=\"language-text\">netlify-plugin-gatsby-cache</code>, que vai persistir as pastas <code class=\"language-text\">public</code> e <code class=\"language-text\">.cache</code> entre os builds.</p>\n<p>No seu arquivo <code class=\"language-text\">netlify.toml</code> na raiz do projeto, adicione o seguinte:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>plugins<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n  package <span class=\"token operator\">=</span> <span class=\"token string\">\"netlify-plugin-gatsby-cache\"</span></code></pre></div>\n<h3 id=\"passo-4---adicione-a-flag-para-habilitar-o-gatsby-incremental-builds\">Passo 4 - Adicione a flag para habilitar o Gatsby incremental builds</h3>\n<p>Atualize o comando de <code class=\"language-text\">build</code> no seu <code class=\"language-text\">package.json</code> para incluir a seguinte flag:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"develop\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"gatsby develop\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"build\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"GATSBY_EXPERIMENTAL_PAGE_BUILD_ON_DATA_CHANGES=true gatsby build --log-pages\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>A flag <code class=\"language-text\">--log-pages</code> irá mostrar quais páginas o Gatsby fez build em cada deploy, é opcional e se você quiser, basta remover.</p>\n<h3 id=\"passo-5-faca-alguma-mudanca-e-veja-funcionando\">Passo 5: Faça alguma mudança e veja funcionando!</h3>\n<p>Assim que você fizer todas as mudanças acima, o site já estará preparado para os builds incrementais. Na primeira vez que você subir alguma mudança, ele irá demorar o mesmo tempo que já demora atualmente, porém já guardando os arquivos no cache.</p>\n<p>Na segunda vez que você rodar, prepare-se para um build bem mais rápido!</p>\n<h2 id=\"conclusao\">Conclusão</h2>\n<p>É isso aí galera, foi um post rapidinho, mas que espero que seja útil para todos vocês, eu amo a dupla Gatsby+Netlify e eles estão cada vez mais se superando!</p>\n<p>E se você não chegou a fazer meu curso de Gatsby, aproveita esse <a href=\"https://www.udemy.com/course/gatsby-crie-um-site-pwa-com-react-graphql-e-netlify-cms/?couponCode=ESTUDEEMCASA\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">lindo cupom de desconto</a> e corre logo para estudar!</p>","fields":{"slug":"/build-incremental-gatsby-netlify/"},"frontmatter":{"date":"24 April 2020","image":"/assets/img/netlify/main.png","description":"Tenha builds muito mais rápidos com a nova atualização do Gatsby Incremental Build.","title":"Como habilitar builds incrementais do Gatsby no Netlify"},"timeToRead":3}},"pageContext":{"slug":"/build-incremental-gatsby-netlify/","previous":{"fields":{"slug":"/structure-react-native-project copy/"},"frontmatter":{"title":"Structure a React Native App","date":"11 April 2020"}},"next":{"fields":{"slug":"/what-is-iam/"},"frontmatter":{"title":"What is IAM? (A beginner's guide)","date":"25 May 2020"}}}},"staticQueryHashes":["185390462","63159454","844308772"]}